<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Pixel Miner Pro</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #1a1a2e;
            color: #fff;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            overflow: hidden;
            touch-action: manipulation;
        }

        .stat-box { text-align: center; margin-bottom: 20px; z-index: 5; }
        #gold-count { font-size: 2.5rem; font-weight: bold; color: #f1c40f; }
        .prestige-text { color: #9b59b6; font-size: 0.9rem; font-weight: bold; }

        #click-container { position: relative; margin-bottom: 20px; z-index: 5; }
        #click-btn {
            width: 160px; height: 160px;
            border-radius: 50%; border: none;
            background: radial-gradient(#f39c12, #d35400);
            color: white; font-size: 1.2rem; font-weight: bold;
            box-shadow: 0 8px #a04000;
            transition: transform 0.05s;
        }
        #click-btn:active { transform: scale(0.95); box-shadow: 0 2px #a04000; }

        .upgrade-section { width: 90%; max-width: 400px; display: flex; flex-direction: column; gap: 10px; z-index: 5; }
        .upgrade-btn {
            width: 100%; padding: 12px; background: #16213e;
            border: 1px solid #4ecca3; color: white; border-radius: 8px;
            display: flex; justify-content: space-between; align-items: center;
        }
        .upgrade-btn:disabled { opacity: 0.3; filter: grayscale(1); }
        
        #prestige-btn { background: #4a148c; border: 1px solid #9b59b6; display: none; }
        .cost-tag { background: #0f3460; padding: 2px 8px; border-radius: 4px; color: #4ecca3; }

        /* Floating Text Animation */
        .floating-text {
            position: absolute; color: #f1c40f; font-weight: bold;
            pointer-events: none; animation: floatUp 0.8s ease-out forwards;
        }
        @keyframes floatUp {
            0% { transform: translateY(0); opacity: 1; }
            100% { transform: translateY(-100px); opacity: 0; }
        }

        /* Lucky Nugget Style */
        #lucky-nugget {
            position: absolute;
            width: 60px;
            height: 60px;
            background: #f1c40f;
            border: 4px solid #fff;
            border-radius: 50%;
            display: none;
            z-index: 100;
            box-shadow: 0 0 20px #f1c40f;
            cursor: pointer;
            animation: pulse 1s infinite alternate;
        }
        @keyframes pulse {
            from { transform: scale(1); }
            to { transform: scale(1.2); }
        }
    </style>
</head>
<body>

    <div id="lucky-nugget"></div>

    <div class="stat-box">
        <div class="prestige-text">Multi: x<span id="prestige-multi">1</span></div>
        <div>Gold: <span id="gold-count">0</span></div>
        <div style="font-size: 1rem; color: #f1c40f;">+<span id="gps-count">0</span>/s</div>
    </div>

    <div id="click-container">
        <button id="click-btn">MINE!</button>
    </div>

    <div class="upgrade-section">
        <button id="buy-clicker" class="upgrade-btn">
            <span>Upgrade Pickaxe</span>
            <span id="clicker-cost" class="cost-tag">15 G</span>
        </button>

        <button id="buy-miner" class="upgrade-btn">
            <span>Auto-Miner</span>
            <span id="miner-cost" class="cost-tag">10 G</span>
        </button>

        <button id="prestige-btn" class="upgrade-btn">
            <span>ASCEND</span>
            <span class="cost-tag">+1 Multi</span>
        </button>
        
        <button onclick="hardReset()" style="background:none; border:none; color:#555; font-size:10px; margin-top:10px;">Hard Reset Data</button>
    </div>

    <script>
        let gold = 0;
        let miners = 0;
        let minerCost = 10;
        let clickValue = 1;
        let clickerCost = 15;
        let prestige = 1;

        const goldDisplay = document.getElementById('gold-count');
        const gpsDisplay = document.getElementById('gps-count');
        const multiDisplay = document.getElementById('prestige-multi');
        const minerCostDisplay = document.getElementById('miner-cost');
        const clickerCostDisplay = document.getElementById('clicker-cost');
        const buyMinerBtn = document.getElementById('buy-miner');
        const buyClickerBtn = document.getElementById('buy-clicker');
        const prestigeBtn = document.getElementById('prestige-btn');
        const clickContainer = document.getElementById('click-container');
        const luckyNugget = document.getElementById('lucky-nugget');

        function updateUI() {
            goldDisplay.innerText = Math.floor(gold || 0);
            gpsDisplay.innerText = ((miners || 0) * (prestige || 1)).toFixed(1);
            multiDisplay.innerText = prestige || 1;
            minerCostDisplay.innerText = (minerCost || 10) + " G";
            clickerCostDisplay.innerText = (clickerCost || 15) + " G";
            
            buyMinerBtn.disabled = (gold < minerCost);
            buyClickerBtn.disabled = (gold < clickerCost);
            prestigeBtn.style.display = (gold >= 1000 || prestige > 1) ? "flex" : "none";
            prestigeBtn.disabled = (gold < 1000);
        }

        function spawnText(amount, x, y, isBonus = false) {
            const text = document.createElement('div');
            text.className = 'floating-text';
            if (isBonus) text.style.color = "#4ecca3";
            text.innerText = '+' + amount;
            text.style.left = x || (Math.random() * 80 + '%');
            text.style.top = y || '50%';
            clickContainer.appendChild(text);
            setTimeout(() => text.remove(), 800);
        }

        // Main Mining Click
        document.getElementById('click-btn').addEventListener('click', () => {
            let totalGain = (clickValue || 1) * (prestige || 1);
            gold += totalGain;
            spawnText(totalGain);
            updateUI();
        });

        // Lucky Nugget Click
        luckyNugget.addEventListener('click', () => {
            let bonus = Math.floor(((miners * prestige) * 30) + 50);
            gold += bonus;
            spawnText("LUCKY: " + bonus, "50%", "50%", true);
            luckyNugget.style.display = 'none';
            updateUI();
        });

        // Lucky Nugget Spawner Loop
        setInterval(() => {
            if (Math.random() > 0.7) { // 30% chance every 10s
                const x = Math.random() * (window.innerWidth - 60);
                const y = Math.random() * (window.innerHeight - 60);
                luckyNugget.style.left = x + 'px';
                luckyNugget.style.top = y + 'px';
                luckyNugget.style.display = 'block';
                
                // Disappear after 4 seconds
                setTimeout(() => { luckyNugget.style.display = 'none'; }, 4000);
            }
        }, 10000);

        buyClickerBtn.addEventListener('click', () => {
            if (gold >= clickerCost) {
                gold -= clickerCost;
                clickValue = (clickValue || 1) + 1;
                clickerCost = Math.floor(clickerCost * 1.5);
                updateUI();
                saveGame();
            }
        });

        buyMinerBtn.addEventListener('click', () => {
            if (gold >= minerCost) {
                gold -= minerCost;
                miners = (miners || 0) + 1;
                minerCost = Math.floor(minerCost * 1.2);
                updateUI();
                saveGame();
            }
        });

        prestigeBtn.addEventListener('click', () => {
            if (confirm("Ascend for +1x Multiplier?")) {
                prestige = (prestige || 1) + 1;
                gold = 0; miners = 0; minerCost = 10;
                clickValue = 1; clickerCost = 15;
                saveGame();
                updateUI();
            }
        });

        function saveGame() {
            const data = { gold, miners, minerCost, clickValue, clickerCost, prestige };
            localStorage.setItem("pixelMinerSave", JSON.stringify(data));
        }

        function loadGame() {
            try {
                const saved = localStorage.getItem("pixelMinerSave");
                if (saved) {
                    const data = JSON.parse(saved);
                    gold = Number.isFinite(data.gold) ? data.gold : 0;
                    miners = Number.isFinite(data.miners) ? data.miners : 0;
                    minerCost = Number.isFinite(data.minerCost) ? data.minerCost : 10;
                    clickValue = Number.isFinite(data.clickValue) ? data.clickValue : 1;
                    clickerCost = Number.isFinite(data.clickerCost) ? data.clickerCost : 15;
                    prestige = Number.isFinite(data.prestige) ? data.prestige : 1;
                }
            } catch (e) { console.log("Save error"); }
            updateUI();
        }

        function hardReset() {
            if(confirm("Wipe all data?")) {
                localStorage.clear();
                location.reload();
            }
        }

        setInterval(() => {
            gold += ((miners || 0) * (prestige || 1));
            updateUI();
        }, 1000);

        loadGame();
    </script>
</body>
</html>
