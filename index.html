<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Pixel Miner: Mega Update</title>
    <style>
        :root {
            --bg-color: #0f0c29;
            --text-color: #ffffff;
            --card-bg: rgba(255, 255, 255, 0.1);
            --accent: #00d2ff;
            --gold: #f1c40f;
            --btn-skin: radial-gradient(#f39c12, #d35400);
        }

        body {
            font-family: 'Segoe UI', sans-serif;
            background: linear-gradient(to bottom, #0f0c29, #302b63, #24243e);
            color: var(--text-color);
            margin: 0; display: flex; flex-direction: column; align-items: center;
            height: 100vh; overflow: hidden; touch-action: manipulation; transition: 0.5s;
        }

        /* News Ticker */
        #news-ticker {
            width: 100%; background: rgba(0,0,0,0.5); font-size: 0.7rem;
            padding: 5px 0; overflow: hidden; white-space: nowrap; margin-top: 25px;
        }
        #news-content { display: inline-block; animation: scrollText 15s linear infinite; }
        @keyframes scrollText { from { transform: translateX(100%); } to { transform: translateX(-100%); } }

        /* Level Bar */
        #xp-container { position: fixed; top: 0; width: 100%; height: 25px; background: #222; z-index: 1000; }
        #xp-bar { height: 100%; width: 0%; background: var(--accent); transition: 0.3s; box-shadow: 0 0 10px var(--accent); }

        .stat-group { text-align: center; margin: 10px 0; }
        #gold-display { font-size: 3rem; font-weight: bold; color: var(--gold); text-shadow: 0 0 10px rgba(241, 196, 15, 0.5); }
        
        /* Combo Meter */
        #combo-meter { font-size: 0.8rem; color: #ff7675; opacity: 0; transition: 0.3s; }

        /* The Button */
        #mine-btn {
            width: 150px; height: 150px; border-radius: 50%; border: 4px solid #fff;
            background: var(--btn-skin); color: #fff; font-size: 1.2rem; font-weight: bold;
            box-shadow: 0 10px 20px rgba(0,0,0,0.5); transition: 0.1s; cursor: pointer;
        }
        #mine-btn:active { transform: scale(0.9); box-shadow: 0 2px 5px rgba(0,0,0,0.5); }

        /* Upgrade Area (Scrollable for mobile) */
        .shop-container {
            width: 95%; flex-grow: 1; overflow-y: auto; 
            padding: 10px 0; display: flex; flex-direction: column; gap: 10px;
        }
        .item {
            background: var(--card-bg); border: 1px solid rgba(255,255,255,0.2);
            padding: 12px; border-radius: 12px; display: flex; justify-content: space-between; align-items: center;
        }
        .item-info b { display: block; font-size: 1rem; }
        .item-info span { font-size: 0.75rem; color: #ccc; }
        .buy-btn { background: var(--accent); border: none; padding: 8px 15px; border-radius: 8px; color: #000; font-weight: bold; }
        .buy-btn:disabled { background: #555; color: #888; }

        /* Floating Items */
        .float-txt { position: absolute; pointer-events: none; animation: floatUp 0.8s ease-out forwards; font-weight: bold; z-index: 2000; }
        @keyframes floatUp { 0% { transform: translateY(0); opacity: 1; } 100% { transform: translateY(-100px); opacity: 0; } }
    </style>
</head>
<body>

    <div id="xp-container"><div id="xp-bar"></div></div>

    <div id="news-ticker"><div id="news-content">BREAKING: Local Miner Finds Golden Potato... Shares skyrocketed...</div></div>

    <div class="stat-group">
        <div id="combo-meter">COMBO X1.0</div>
        <div id="gold-display">0</div>
        <div style="color: var(--accent); font-size: 0.9rem;">+<span id="gps">0</span>/s</div>
    </div>

    <button id="mine-btn">MINE!</button>

    <div class="shop-container">
        <div class="item">
            <div class="item-info"><b>Reinforced Pickaxe</b><span id="p-lvl">Lvl 1</span></div>
            <button class="buy-btn" onclick="buyUpgrade('click')"><span id="p-cost">15</span> G</button>
        </div>
        <div class="item">
            <div class="item-info"><b>Auto-Bot</b><span id="m-lvl">Lvl 0</span></div>
            <button class="buy-btn" onclick="buyUpgrade('miner')"><span id="m-cost">50</span> G</button>
        </div>
        <div class="item">
            <div class="item-info"><b>Button Skin: Neon</b><span>Cost: 500 G</span></div>
            <button class="buy-btn" onclick="changeSkin('linear-gradient(#00d2ff, #3a7bd5)')">BUY</button>
        </div>
    </div>

    <script>
        // --- DATA ---
        let gold = 0, gps = 0, clickPower = 1;
        let pLvl = 1, pCost = 15;
        let mLvl = 0, mCost = 50;
        let xp = 0, nextXp = 100, lvl = 1;
        let combo = 1, comboTimer;
        
        const news = [
            "Local miner discovers gold in a sandwich.",
            "Goblins protest against auto-miners.",
            "Gold prices hit an all-time high!",
            "New: Diamond pickaxes actually made of glass?",
            "Breaking: Clicking too fast causes finger-glow."
        ];

        // --- CORE LOGIC ---
        const mineBtn = document.getElementById('mine-btn');

        mineBtn.onclick = (e) => {
            // Combo System
            combo += 0.01;
            document.getElementById('combo-meter').style.opacity = 1;
            document.getElementById('combo-meter').innerText = `COMBO X${combo.toFixed(1)}`;
            clearTimeout(comboTimer);
            comboTimer = setTimeout(() => { combo = 1; document.getElementById('combo-meter').style.opacity = 0; }, 2000);

            // Gold Logic
            let gain = clickPower * combo;
            if (Math.random() < 0.05) { gain *= 5; spawnText("CRIT!", e.pageX, e.pageY, "#e74c3c"); }
            
            addGold(gain);
            spawnText(`+${gain.toFixed(1)}`, e.pageX, e.pageY);
            
            // Haptic Feedback
            if (navigator.vibrate) navigator.vibrate(20);
        };

        function addGold(amt) {
            gold += amt;
            xp += amt * 0.5;
            if (xp >= nextXp) levelUp();
            updateUI();
        }

        function levelUp() {
            lvl++;
            xp = 0;
            nextXp *= 1.5;
            addGold(lvl * 100);
            spawnText("LEVEL UP!", window.innerWidth/2, window.innerHeight/2, "#00d2ff");
        }

        function buyUpgrade(type) {
            if (type === 'click' && gold >= pCost) {
                gold -= pCost; pLvl++; clickPower += 2; pCost *= 1.6;
            } else if (type === 'miner' && gold >= mCost) {
                gold -= mCost; mLvl++; gps += 1.5; mCost *= 1.3;
            }
            updateUI();
        }

        function updateUI() {
            document.getElementById('gold-display').innerText = Math.floor(gold);
            document.getElementById('gps').innerText = gps.toFixed(1);
            document.getElementById('p-lvl').innerText = `Lvl ${pLvl}`;
            document.getElementById('p-cost').innerText = Math.floor(pCost);
            document.getElementById('m-lvl').innerText = `Lvl ${mLvl}`;
            document.getElementById('m-cost').innerText = Math.floor(mCost);
            document.getElementById('xp-bar').style.width = `${(xp/nextXp)*100}%`;
        }

        function spawnText(txt, x, y, color = "#f1c40f") {
            const el = document.createElement('div');
            el.className = 'float-txt';
            el.innerText = txt;
            el.style.left = `${x}px`;
            el.style.top = `${y}px`;
            el.style.color = color;
            document.body.appendChild(el);
            setTimeout(() => el.remove(), 800);
        }

        function changeSkin(skin) {
            if (gold >= 500) {
                gold -= 500;
                document.documentElement.style.setProperty('--btn-skin', skin);
                updateUI();
            }
        }

        // --- LOOPS ---
        setInterval(() => { if (gps > 0) addGold(gps / 10); }, 100); // 10 ticks per second
        
        setInterval(() => {
            const content = document.getElementById('news-content');
            content.innerText = news[Math.floor(Math.random() * news.length)];
        }, 15000);

        // Shake to mine
        let lastX, lastY, lastZ;
        window.ondevicemotion = (e) => {
            let acc = e.accelerationIncludingGravity;
            if (Math.abs(acc.x - lastX) > 15) addGold(clickPower);
            lastX = acc.x;
        };

        updateUI();
    </script>
</body>
</html>
