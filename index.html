<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Pixel Miner Pro</title>
    <style>
        :root {
            --bg-color: #1a1a2e;
            --text-color: #ffffff;
            --card-bg: #16213e;
            --accent: #4ecca3;
            --boss-color: #e74c3c;
            --xp-color: #3498db;
            --trophy-gold: #f1c40f;
        }

        body.light-mode {
            --bg-color: #f0f2f5;
            --text-color: #1a1a2e;
            --card-bg: #ffffff;
            --accent: #2ecc71;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            height: 100vh;
            margin: 0;
            overflow: hidden;
            touch-action: manipulation;
            transition: 0.3s;
        }

        /* UI Layering */
        #level-container {
            position: fixed; top: 0; width: 100%; height: 25px;
            background: #333; display: flex; align-items: center; z-index: 50;
        }
        #xp-bar-fill { height: 100%; width: 0%; background: var(--xp-color); transition: width 0.3s; }
        #level-text { position: absolute; width: 100%; text-align: center; font-size: 0.75rem; font-weight: bold; color: white; }

        .header { 
            margin-top: 35px; display: flex; width: 90%; justify-content: space-between; align-items: center; z-index: 100;
        }
        
        #mine-name-display { font-size: 1rem; font-weight: bold; border-bottom: 1px dashed var(--accent); }

        .stat-box { text-align: center; margin-top: 10px; }
        #gold-count { font-size: 2.5rem; font-weight: bold; color: var(--trophy-gold); }

        /* Clicking Area */
        #click-container { position: relative; margin: 20px 0; }
        #click-btn {
            width: 140px; height: 140px; border-radius: 50%; border: none;
            background: radial-gradient(#f39c12, #d35400); color: white;
            font-size: 1.1rem; font-weight: bold; box-shadow: 0 8px #a04000;
            transition: transform 0.05s; z-index: 10;
        }
        #click-btn:active { transform: scale(0.92); }

        /* Particle Style */
        .particle {
            position: absolute; width: 8px; height: 8px;
            background-color: var(--trophy-gold);
            pointer-events: none; border-radius: 2px;
            z-index: 1000;
        }

        /* Upgrades */
        .upgrade-section { width: 90%; max-width: 400px; display: flex; flex-direction: column; gap: 8px; }
        .upgrade-btn {
            width: 100%; padding: 12px; background: var(--card-bg);
            border: 1px solid var(--accent); color: var(--text-color); border-radius: 10px;
            display: flex; justify-content: space-between; align-items: center;
        }
        .cost-tag { background: #0f3460; padding: 3px 8px; border-radius: 6px; color: #4ecca3; font-weight: bold; }

        /* Floating Text */
        .floating-text {
            position: absolute; color: var(--trophy-gold); font-weight: bold; pointer-events: none;
            animation: floatUp 0.7s ease-out forwards; z-index: 1001;
        }
        @keyframes floatUp { 0% { transform: translateY(0); opacity: 1; } 100% { transform: translateY(-80px); opacity: 0; } }

        /* Trophy Menu */
        #trophy-menu {
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
            width: 85%; max-width: 320px; background: var(--card-bg);
            border: 2px solid var(--trophy-gold); border-radius: 15px;
            padding: 20px; z-index: 2000; display: none; text-align: center;
        }
    </style>
</head>
<body class="dark-mode">

    <div id="level-container">
        <div id="xp-bar-fill"></div>
        <div id="level-text">Level <span id="current-lvl">1</span></div>
    </div>

    <div class="header">
        <span id="mine-name-display" onclick="renameMine()">My Mine</span>
        <div style="display: flex; gap: 8px;">
            <button onclick="toggleTrophy()" style="background:var(--trophy-gold); border:none; border-radius:10px; padding:6px 12px; font-weight:bold;">üèÜ</button>
            <button onclick="toggleTheme()" style="background:var(--card-bg); border:1px solid var(--accent); color:var(--text-color); border-radius:10px; padding:6px 12px;">üåì</button>
        </div>
    </div>

    <div id="trophy-menu">
        <h2 style="color:var(--trophy-gold)">Mine Stats</h2>
        <p>Total Taps: <span id="stat-taps">0</span></p>
        <p>Lifetime Gold: <span id="stat-life-gold">0</span></p>
        <button onclick="toggleTrophy()" style="padding:10px 20px; background:var(--accent); border:none; border-radius:10px; color:white; font-weight:bold;">CLOSE</button>
    </div>

    <div class="stat-box">
        <div style="color: #9b59b6; font-size: 0.8rem;">Multi: x<span id="prestige-multi">1.0</span></div>
        <div id="gold-count">0</div>
        <div style="font-size: 0.9rem; color: var(--trophy-gold);">+<span id="gps-count">0</span>/s</div>
    </div>

    <div id="click-container">
        <button id="click-btn">MINE!</button>
    </div>

    <div class="upgrade-section">
        <button id="buy-clicker" class="upgrade-btn">
            <span>Pickaxe (Lvl <span id="click-lvl">1</span>)</span>
            <span id="clicker-cost" class="cost-tag">15 G</span>
        </button>
        <button id="buy-miner" class="upgrade-btn">
            <span>Miners (Lvl <span id="miner-lvl">0</span>)</span>
            <span id="miner-cost" class="cost-tag">10 G</span>
        </button>
        <button id="prestige-btn" class="upgrade-btn" style="background:#4a148c; display:none; color:white;">
            <span>ASCEND</span>
            <span class="cost-tag">+1 Multi</span>
        </button>
        <button onclick="hardReset()" style="color:#777; font-size:10px; border:none; background:none; margin-top:10px;">Hard Reset Progress</button>
    </div>

    <script>
        let gold = 0, miners = 0, minerCost = 10, clickValue = 1, clickerCost = 15;
        let prestige = 1, clickerLvl = 1, mineName = "My Mine", isDarkMode = true;
        let playerLevel = 1, currentXP = 0, xpNeeded = 100;
        let lifetimeGold = 0, totalTaps = 0;

        // Particle Effect Logic
        function createParticle(x, y) {
            const p = document.createElement('div');
            p.className = 'particle';
            document.body.appendChild(p);

            const size = Math.random() * 8 + 4;
            p.style.width = `${size}px`;
            p.style.height = `${size}px`;
            p.style.left = `${x}px`;
            p.style.top = `${y}px`;

            const destinationX = x + (Math.random() - 0.5) * 200;
            const destinationY = y + (Math.random() - 0.5) * 200;

            const animation = p.animate([
                { transform: 'translate(0, 0) rotate(0deg)', opacity: 1 },
                { transform: `translate(${destinationX - x}px, ${destinationY - y}px) rotate(360deg)`, opacity: 0 }
            ], {
                duration: 500 + Math.random() * 500,
                easing: 'cubic-bezier(0, .9, .57, 1)',
                delay: Math.random() * 50
            });

            animation.onfinish = () => p.remove();
        }

        function updateUI() {
            document.getElementById('gold-count').innerText = Math.floor(gold);
            const mBonus = Math.floor(miners / 10) + 1;
            const lvlBonus = 1 + (playerLevel * 0.1);
            document.getElementById('gps-count').innerText = (miners * prestige * mBonus * lvlBonus).toFixed(1);
            document.getElementById('prestige-multi').innerText = (prestige * lvlBonus).toFixed(1);
            
            document.getElementById('miner-cost').innerText = minerCost + " G";
            document.getElementById('clicker-cost').innerText = clickerCost + " G";
            document.getElementById('miner-lvl').innerText = miners;
            document.getElementById('click-lvl').innerText = clickerLvl;
            document.getElementById('mine-name-display').innerText = mineName;

            const percent = Math.min((currentXP / xpNeeded) * 100, 100);
            document.getElementById('xp-bar-fill').style.width = percent + "%";
            document.getElementById('current-lvl').innerText = playerLevel;

            document.getElementById('buy-miner').disabled = gold < minerCost;
            document.getElementById('buy-clicker').disabled = gold < clickerCost;
            document.getElementById('prestige-btn').style.display = gold >= 1000 ? "flex" : "none";
            
            document.getElementById('stat-taps').innerText = totalTaps;
            document.getElementById('stat-life-gold').innerText = Math.floor(lifetimeGold);
        }

        function gainXP(amt) {
            currentXP += amt;
            while (currentXP >= xpNeeded) {
                currentXP -= xpNeeded; playerLevel++;
                xpNeeded = Math.floor(xpNeeded * 1.3);
            }
            updateUI();
        }

        document.getElementById('click-btn').addEventListener('click', (e) => {
            const cBonus = Math.floor(clickerLvl / 10) + 1;
            const lvlBonus = 1 + (playerLevel * 0.1);
            let gain = clickValue * prestige * cBonus * lvlBonus;
            gold += gain; lifetimeGold += gain; totalTaps++;
            
            gainXP(gain * 0.5);
            spawnText(Math.floor(gain), e.clientX, e.clientY);
            
            // Spawn 5 particles per click
            for(let i=0; i<5; i++) createParticle(e.clientX, e.clientY);
            
            updateUI();
        });

        function spawnText(amt, x, y) {
            const t = document.createElement('div');
            t.className = 'floating-text';
            t.innerText = "+" + amt;
            t.style.left = (x || (window.innerWidth / 2)) + "px"; 
            t.style.top = (y || (window.innerHeight / 2)) + "px";
            document.body.appendChild(t);
            setTimeout(() => t.remove(), 700);
        }

        // --- STANDARD BUTTONS ---
        document.getElementById('buy-clicker').addEventListener('click', () => {
            if (gold >= clickerCost) {
                gold -= clickerCost; clickerLvl++; clickValue++;
                clickerCost = Math.floor(clickerCost * 1.6);
                updateUI(); saveGame();
            }
        });

        document.getElementById('buy-miner').addEventListener('click', () => {
            if (gold >= minerCost) {
                gold -= minerCost; miners++;
                minerCost = Math.floor(minerCost * 1.25);
                updateUI(); saveGame();
            }
        });

        document.getElementById('prestige-btn').addEventListener('click', () => {
            if (confirm("Ascend?")) {
                prestige++; gold = 0; miners = 0; minerCost = 10;
                clickValue = 1; clickerCost = 15; clickerLvl = 1;
                saveGame(); updateUI();
            }
        });

        function toggleTrophy() {
            const m = document.getElementById('trophy-menu');
            m.style.display = m.style.display === 'block' ? 'none' : 'block';
        }

        function toggleTheme() {
            isDarkMode = !isDarkMode;
            document.body.className = isDarkMode ? "dark-mode" : "light-mode";
            saveGame();
        }

        function renameMine() {
            const n = prompt("Mine Name:", mineName);
            if(n) { mineName = n; updateUI(); saveGame(); }
        }

        function saveGame() {
            const data = { gold, miners, minerCost, clickValue, clickerCost, prestige, mineName, isDarkMode, clickerLvl, playerLevel, currentXP, xpNeeded, lifetimeGold, totalTaps };
            localStorage.setItem("pixelMinerV8", JSON.stringify(data));
        }

        function loadGame() {
            const saved = localStorage.getItem("pixelMinerV8");
            if(saved) {
                const d = JSON.parse(saved);
                gold = Number(d.gold) || 0; miners = Number(d.miners) || 0;
                minerCost = Number(d.minerCost) || 10; clickValue = Number(d.clickValue) || 1;
                clickerCost = Number(d.clickerCost) || 15; prestige = Number(d.prestige) || 1;
                clickerLvl = Number(d.clickerLvl) || 1; mineName = d.mineName || "My Mine";
                playerLevel = Number(d.playerLevel) || 1; currentXP = Number(d.currentXP) || 0;
                xpNeeded = Number(d.xpNeeded) || 100; lifetimeGold = Number(d.lifetimeGold) || 0;
                totalTaps = Number(d.totalTaps) || 0; isDarkMode = d.isDarkMode ?? true;
                document.body.className = isDarkMode ? "dark-mode" : "light-mode";
            }
            updateUI();
        }

        setInterval(() => {
            const mBonus = Math.floor(miners / 10) + 1;
            const lvlBonus = 1 + (playerLevel * 0.1);
            let pGain = miners * prestige * mBonus * lvlBonus;
            if (pGain > 0) {
                gold += pGain; lifetimeGold += pGain;
                gainXP(pGain * 0.1);
            }
            updateUI();
        }, 1000);

        function hardReset() { if(confirm("Reset?")) { localStorage.clear(); location.reload(); } }
        loadGame();
    </script>
</body>
</html>
