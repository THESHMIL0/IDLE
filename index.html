<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Pixel Miner: GOD MODE</title>
    <style>
        :root {
            --primary: #00d2ff; --gold: #f1c40f; --bg: #0f0c29;
            --card: rgba(255,255,255,0.08); --pink: #e84393;
        }
        body {
            margin: 0; background: var(--bg); color: #fff; font-family: 'Segoe UI', sans-serif;
            height: 100vh; display: flex; flex-direction: column; overflow: hidden; touch-action: manipulation;
        }
        /* Top HUD */
        #hud { width: 100%; padding: 35px 15px 10px; box-sizing: border-box; background: rgba(0,0,0,0.4); z-index: 100; }
        .bar-bg { width: 100%; height: 6px; background: #333; border-radius: 3px; margin-top: 5px; }
        #xp-bar { width: 0%; height: 100%; background: var(--primary); border-radius: 3px; transition: 0.3s; box-shadow: 0 0 10px var(--primary); }
        
        /* Stats */
        #gold-count { font-size: 3.5rem; font-weight: 900; text-align: center; color: var(--gold); margin: 10px 0; text-shadow: 0 0 20px rgba(241,196,15,0.3); }
        #sub-stats { display: flex; justify-content: space-around; font-size: 0.8rem; color: #aaa; }

        /* Game Canvas Area */
        #game-world { position: relative; flex-grow: 1; display: flex; justify-content: center; align-items: center; }
        #main-target {
            width: 160px; height: 160px; border-radius: 50%; border: 6px solid #fff;
            background: radial-gradient(circle, #3a7bd5, #00d2ff);
            box-shadow: 0 0 30px rgba(0,210,255,0.4); transition: 0.1s; z-index: 10;
        }
        #main-target:active { transform: scale(0.85); rotate: 5deg; }

        /* Floating UI */
        .pop { position: absolute; pointer-events: none; animation: popUp 0.6s ease-out forwards; font-weight: bold; z-index: 50; }
        @keyframes popUp { 0% { transform: scale(0.5) translateY(0); opacity: 1; } 100% { transform: scale(1.2) translateY(-120px); opacity: 0; } }

        /* Shop Tray */
        #shop {
            height: 35%; background: #1a1a2e; border-top: 3px solid var(--primary);
            padding: 15px; overflow-y: auto; display: grid; gap: 10px;
        }
        .u-card {
            background: var(--card); padding: 12px; border-radius: 12px;
            display: flex; justify-content: space-between; align-items: center; border: 1px solid rgba(255,255,255,0.1);
        }
        .u-btn { background: var(--primary); border: none; padding: 10px 18px; border-radius: 8px; font-weight: bold; color: #000; }
        .u-btn:disabled { background: #444; color: #777; }

        /* Weather Effects */
        #weather { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 1; }
    </style>
</head>
<body>

    <div id="hud">
        <div style="display: flex; justify-content: space-between; font-size: 0.7rem;">
            <span>RANK: <span id="rank-name">NOVICE</span></span>
            <span>LVL <span id="lvl">1</span></span>
        </div>
        <div class="bar-bg"><div id="xp-bar"></div></div>
    </div>

    <div id="gold-count">0</div>
    <div id="sub-stats">
        <span>GPS: <span id="gps">0</span></span>
        <span>MULTI: x<span id="multi">1.0</span></span>
    </div>

    <div id="game-world">
        <div id="weather"></div>
        <button id="main-target">MINE!</button>
    </div>

    <div id="shop">
        <div class="u-card">
            <div><b>Nano-Drill</b><br><small id="p-lvl">Level 1</small></div>
            <button class="u-btn" id="btn-p" onclick="upgrade('p')"><span id="p-cost">15</span> G</button>
        </div>
        <div class="u-card">
            <div><b>Deep-Sea Bot</b><br><small id="m-lvl">Level 0</small></div>
            <button class="u-btn" id="btn-m" onclick="upgrade('m')"><span id="m-cost">50</span> G</button>
        </div>
    </div>

    <script>
        // --- STATE ---
        let state = {
            gold: 0, gps: 0, power: 1, 
            pLvl: 1, pCost: 15, mLvl: 0, mCost: 50,
            xp: 0, nextXp: 100, lvl: 1,
            lastSave: Date.now()
        };

        const target = document.getElementById('main-target');

        // --- CORE ---
        target.onclick = (e) => {
            let gain = state.power * (1 + (state.lvl * 0.1));
            let isCrit = Math.random() < 0.1;
            if (isCrit) gain *= 5;

            addGold(gain);
            spawnPop(isCrit ? "CRIT!!": `+${Math.floor(gain)}`, e.pageX, e.pageY, isCrit ? "var(--pink)" : "white");
            if(navigator.vibrate) navigator.vibrate(isCrit ? [30, 10, 30] : 15);
        };

        function addGold(amt) {
            state.gold += amt;
            state.xp += amt * 0.4;
            if (state.xp >= state.nextXp) {
                state.lvl++; state.xp = 0; state.nextXp *= 1.6;
                spawnPop("LEVEL UP!", window.innerWidth/2, window.innerHeight/3, "var(--primary)");
            }
            updateUI();
        }

        function upgrade(type) {
            if (type === 'p' && state.gold >= state.pCost) {
                state.gold -= state.pCost; state.pLvl++; state.power += 2; state.pCost *= 1.7;
            } else if (type === 'm' && state.gold >= state.mCost) {
                state.gold -= state.mCost; state.mLvl++; state.gps += 2; state.mCost *= 1.4;
            }
            save(); updateUI();
        }

        function updateUI() {
            document.getElementById('gold-count').innerText = Math.floor(state.gold).toLocaleString();
            document.getElementById('gps').innerText = state.gps.toFixed(1);
            document.getElementById('lvl').innerText = state.lvl;
            document.getElementById('xp-bar').style.width = (state.xp/state.nextXp)*100 + "%";
            document.getElementById('p-cost').innerText = Math.floor(state.pCost);
            document.getElementById('m-cost').innerText = Math.floor(state.mCost);
            document.getElementById('p-lvl').innerText = "Level " + state.pLvl;
            document.getElementById('m-lvl').innerText = "Level " + state.mLvl;
            document.getElementById('btn-p').disabled = state.gold < state.pCost;
            document.getElementById('btn-m').disabled = state.gold < state.mCost;
        }

        function spawnPop(txt, x, y, color) {
            const div = document.createElement('div');
            div.className = 'pop'; div.innerText = txt;
            div.style.left = x + 'px'; div.style.top = y + 'px'; div.style.color = color;
            document.body.appendChild(div);
            setTimeout(() => div.remove(), 600);
        }

        // --- SYSTEM ---
        function save() {
            state.lastSave = Date.now();
            localStorage.setItem('miner_god_save', JSON.stringify(state));
        }

        function load() {
            const data = localStorage.getItem('miner_god_save');
            if (data) {
                state = {...state, ...JSON.parse(data)};
                let awayTime = (Date.now() - state.lastSave) / 1000;
                if (awayTime > 60 && state.gps > 0) {
                    let earned = awayTime * state.gps * 0.5; // 50% efficiency away
                    addGold(earned);
                    alert(`Welcome back! You earned ${Math.floor(earned)} Gold while away!`);
                }
            }
            updateUI();
        }

        setInterval(() => { if(state.gps > 0) addGold(state.gps / 10); }, 100);
        setInterval(save, 30000);
        
        load();
    </script>
</body>
</html>
